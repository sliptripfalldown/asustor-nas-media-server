# NAS Media Server - Default Configuration
# Source this file in scripts: source "$(dirname "$0")/../config/defaults.env"
# Override with ~/.nas-media-server.env if needed

# ========================================
# USER CONFIGURATION
# ========================================
export APP_USER="${APP_USER:-anon}"
export APP_GROUP="${APP_GROUP:-anon}"
export HOME_DIR="${HOME_DIR:-/home/${APP_USER}}"
export MEDIA_ROOT="${MEDIA_ROOT:-/tank/media}"

# ========================================
# NETWORK CONFIGURATION
# ========================================
# VPN Namespace
export VPN_NAMESPACE_IP="${VPN_NAMESPACE_IP:-10.200.200.2}"
export HOST_BRIDGE_IP="${HOST_BRIDGE_IP:-10.200.200.1}"
export VPN_SUBNET="${VPN_SUBNET:-10.200.200.0/24}"

# Local networks (bypass VPN)
export LOCAL_NETWORKS="${LOCAL_NETWORKS:-192.168.0.0/16,10.200.40.0/24,172.16.0.0/12}"

# Proton VPN DNS
export PROTON_DNS="${PROTON_DNS:-10.2.0.1}"

# ========================================
# SERVICE PORTS
# ========================================
export QB_PORT="${QB_PORT:-8080}"
export PROWLARR_PORT="${PROWLARR_PORT:-9696}"
export FLARESOLVERR_PORT="${FLARESOLVERR_PORT:-8191}"
export RADARR_PORT="${RADARR_PORT:-7878}"
export SONARR_PORT="${SONARR_PORT:-8989}"
export LIDARR_PORT="${LIDARR_PORT:-8686}"
export READARR_PORT="${READARR_PORT:-8787}"
export LAZYLIBRARIAN_PORT="${LAZYLIBRARIAN_PORT:-5299}"
export JELLYFIN_PORT="${JELLYFIN_PORT:-8096}"

# ========================================
# PATHS
# ========================================
export SCRIPT_DIR="${SCRIPT_DIR:-${HOME_DIR}/nas-media-server}"
export CONFIG_DIR="${CONFIG_DIR:-${SCRIPT_DIR}/config}"
export WIREGUARD_DIR="${WIREGUARD_DIR:-${CONFIG_DIR}/wireguard/servers}"

# Application install paths
export OPT_DIR="${OPT_DIR:-/opt}"
export RADARR_DIR="${RADARR_DIR:-${OPT_DIR}/Radarr}"
export SONARR_DIR="${SONARR_DIR:-${OPT_DIR}/Sonarr}"
export LIDARR_DIR="${LIDARR_DIR:-${OPT_DIR}/Lidarr}"
export READARR_DIR="${READARR_DIR:-${OPT_DIR}/Readarr}"
export PROWLARR_DIR="${PROWLARR_DIR:-${OPT_DIR}/Prowlarr}"

# Media paths
export DOWNLOADS_DIR="${DOWNLOADS_DIR:-${MEDIA_ROOT}/downloads}"
export MOVIES_DIR="${MOVIES_DIR:-${MEDIA_ROOT}/movies}"
export TV_DIR="${TV_DIR:-${MEDIA_ROOT}/tv}"
export MUSIC_DIR="${MUSIC_DIR:-${MEDIA_ROOT}/music}"
export BOOKS_DIR="${BOOKS_DIR:-${MEDIA_ROOT}/books}"
export COMICS_DIR="${COMICS_DIR:-${MEDIA_ROOT}/comics}"
export AUDIOBOOKS_DIR="${AUDIOBOOKS_DIR:-${MEDIA_ROOT}/audiobooks}"

# ========================================
# RATIO GUARD SETTINGS
# ========================================
export MAX_RATIO="${MAX_RATIO:-1.5}"
export MAX_RATIO_INCOMPLETE="${MAX_RATIO_INCOMPLETE:-1.0}"
export MAX_RATIO_DEAD_SWARM="${MAX_RATIO_DEAD_SWARM:-5.0}"
export MIN_AVAILABILITY_DEAD="${MIN_AVAILABILITY_DEAD:-0.5}"

# ========================================
# HELPER FUNCTIONS
# ========================================
# Load user overrides if present
if [[ -f "${HOME_DIR}/.nas-media-server.env" ]]; then
    source "${HOME_DIR}/.nas-media-server.env"
fi

# Construct full URLs
export QB_URL="http://${VPN_NAMESPACE_IP}:${QB_PORT}"
export PROWLARR_URL="http://${VPN_NAMESPACE_IP}:${PROWLARR_PORT}"
export FLARESOLVERR_URL="http://${VPN_NAMESPACE_IP}:${FLARESOLVERR_PORT}"
export RADARR_URL="http://localhost:${RADARR_PORT}"
export SONARR_URL="http://localhost:${SONARR_PORT}"
export LIDARR_URL="http://localhost:${LIDARR_PORT}"
export READARR_URL="http://localhost:${READARR_PORT}"
export LAZYLIBRARIAN_URL="http://localhost:${LAZYLIBRARIAN_PORT}"
export JELLYFIN_URL="http://localhost:${JELLYFIN_PORT}"
